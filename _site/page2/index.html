<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>dbsmasher corner &#8211; dbsmasher corner</title>
<meta name="description" content="Thoughts, stories and ideas">


<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@dbsmasher">
<meta name="twitter:creator" content="@dbsmasher">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="dbsmasher corner">
<meta property="og:description" content="Thoughts, stories and ideas">
<meta property="og:url" content="http://localhost:4000/page2/">
<meta property="og:site_name" content="dbsmasher corner">
<meta property="og:image" content="http://localhost:4000/images/images/logo.png">





<link rel="canonical" href="http://localhost:4000/page2/">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="dbsmasher corner Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
<link rel="stylesheet" href="http://localhost:4000/assets/css/jquery.mmenu.all.css">
<link rel="stylesheet" href="http://localhost:4000/assets/css/jquery.floating-social-share.min.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script type="text/javascript" src="http://localhost:4000/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">




</head>

<body id="post-index">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->



<div class="header-menu header-menu-top">
    <ul class="header-item-container">
      <li class="header-item-title header-toggle "><a href="#menu"><h2><i class="fa fa-bars"></i></h2></a></li>
      <li class="header-item-title">
        <a href="http://localhost:4000/">
          
            <img class="logo" src="http://localhost:4000/images/logo.png" alt="dbsmasher corner">
          
          <a href="http://localhost:4000/" class="title"> dbsmasher corner</a>
        </a>
      </li>
      
        
        

        
            
                <li class="header-item "><a href="http://localhost:4000/tags"><h3>Tags</h3></a></li>
            
        
      
        
        

        
            
                <li class="header-item "><a href="http://localhost:4000/"><h3>Home</h3></a></li>
            
        
      
      <li class="header-item"><a href="http://localhost:4000/search"><h3><i class="fa fa-search"></i></h3></a></li>
    </ul>
  </div>
<div class="entry-header">
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>dbsmasher corner</h1>
      
        <h2><span class="entry-date"><time>&nbsp;</time></span></h2>
      

      
          <p class="entry-reading-time">
            &nbsp;
          </p><!-- /.entry-reading-time -->
      
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->


<nav id="menu" style="display: none">
  <ul>
    
      
        <li><a href="http://localhost:4000/"><h3>Home</h3></a></li>
      
    
      
        <li><a href="http://localhost:4000/tags"><h3>Tags</h3></a></li>
      
    
  </ul>
</nav>


  <a href="https://twitter.com/dbsmasher" class="btn btn-info button-twitter" data-show-count="false" data-size="large"><i class="fa fa-twitter"></i> <span> | Follow @dbsmasher</span></a>



<div id="main" role="main">
  
<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2016-01-04T18:22:21-08:00"><a href="http://localhost:4000/2015-review/">January 04, 2016</a></time></span><span class="author vcard"><span class="fn"><a href="http://localhost:4000/about/" title="About Silvia Botros">Silvia Botros</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~4 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://localhost:4000/2015-review/" rel="bookmark" title="2015 in review...2016 here I come" itemprop="url">2015 in review...2016 here I come</a></h1>
    
  </header>
  <div class="entry-content">
      <p><em>This post is inspired by quite a few great posts like this one by <a href="http://beero.ps/2016/01/01/on-to-2016/">Ryn Daniels</a> and <a href="http://larahogan.me/blog/2014-2015/">Lara Hogan</a></em></p>

<p>2015 was a year of lots of changes and lots of growing for me, both professionally and personally. It also had a lot of firsts for me.</p>

<h3 id="going-remote">Going remote</h3>

<p>Late in 2014, I announced to Sendgrid that I am about to move to South Florida where my husband has been working for months. Sendgrid, while distributed in multiple offices, always had all its employees in one of these offices, no truly remote employees. So this was new territory and it was a new challenge given how I am usually collaborating with more than just the Operations team.</p>

<p>After a year, while I do not declare it an absolute success, i feel that I would not still be working at Sendgrid if it weren’t for my team’s and managers’ support. It is easy to declare someone a ‘good employee’, with all the different meanings different companies embue that term with. But the support I got from the team was absolutely crucial to my ability to continue providing value to the company.</p>

<h3 id="first-tech-conference">First Tech conference</h3>

<p>People still get surprised when they hear this but until June of 2015, I had not been to a single tech conference. A combination of being permanently busy, being a mom, moving across country more than a couple of times
have led to having no time to properly plan any tech conference attendance. Finally I took the plunge and I picked <a href="http://monitorama.com/">Monitorama</a> as my first one.</p>

<p>The talks were great. One talk I couldn’t stop referring to since returning was <a href="https://vimeo.com/131484322">“Engineering happiness”</a> By Laura Thompson of Mozilla. I could see myself, post and present co workers in the examples she provided on how a happy engineer slowly becomes less happy with the status quo. One of the first things I did once I returned to work, was share that video with my team lead and engineering leader at the time. I felt it was important to share her advice and to internalize it.</p>

<p>However, conferences are not just about the talks. While I learned a lot in those, I found the hallway track the real gem of that trip and the reason that conference has left lasting memories with me.</p>

<p>I got to meet lots of people I had been following on twitter for a while that I already learned a lot from, and looked up to. I had a LOT of fun talking about being a woman in the ops community with <a href="https://twitter.com/beerops">Katherine Daniels</a> and <a href="https://twitter.com/sigje">Jennifer Davis</a>. Who are about to publish a <a href="http://shop.oreilly.com/product/0636920039846.do">book</a> I am looking forward to. Another set of conversations that were very educational and have pushed some of my 2016 plans was talking about team leadership and management challenges with Roy Rapaport of Netflix.</p>

<p>There are too many people to list here that I enjoyed meeting and talking to at Monitorama. And a lot of those conversations shaped and guided things I have done the rest of the year and things I have planned for 2016.
I cannot recommend enough how great this conference was. Hat tip to <a href="https://twitter.com/obfuscurity">Jason Dixon</a> for creating that great environment and all the #hugops</p>

<h3 id="blog-and-blog-posts">Blog and blog posts</h3>

<p>I started this blog early in 2015. It was not the first time I start a blog and I was not sure if I was gonna keep it up. But then I wrote a blog post for my company and I decided that maybe I will want to write more.</p>

<p>Yes part of that is building personal brand but I was also sometimes frustrated by talking about important things in Devops or in database architecture in 140 character pieces. Yes I did start the blog early in 2015 but it was a blog post by Lara Hogan about <a href="http://larahogan.me/blog/celebrate-achievements/">celebrating our achievements</a>, conversations with my boss in late 2014 and a personal conversation with Jennifer Davis that convinced me that I do have things to say and that my experience so far at Sendgrid could be beneficial to others who are just starting as DBAs.</p>

<p>Most of what I wrote this year was technical or ‘lessons learned’ in the roller coaster of managing databases at a fast growing company. But I also wrote one post that is near and dear to my heard about <a href="https://blog.dbsmasher.com/2015/07/29/on-burnout/">burnout</a> that got me to face how much I needed to take care of me at the same level of commitment I was taking care of servers and databases.</p>

<h3 id="2016-plans">2016 Plans</h3>
<ul>
  <li>Give a tech conference talk. I submitted my <a href="https://www.percona.com/live/data-performance-conference-2016/sessions/bringing-devops-dbas-chef">first ever abstract </a>. Don’t know yet if it will be accepted but I am excited to go to PLCME for the first time nonetheless</li>
  <li>Take better care of me. We hired our second DBA at Sendgrid late 2015. The signs of burnout on me were clear. Nothing is clearer when one performance review says “I fear that Silvia works too hard. She needs to take care of herself” 😊. With onboarding the new member, I hope to be able to split the never ending list of things we need to get done in 2016</li>
  <li>A deeper focus on architecture and automation. I have spent a huge portion of the last few years working with engineers on schema design and bringing the first step of database configuration management to fruition. But a mature infrastructure is more than just configuration management and I hope to be able to grow more skills in larger system design, making the database layer more robust and a true PaaS layer</li>
  <li>Write more technical blog posts. We do so much at Sendgrid. I think we can share lots of lessons learned and I hope I can help with that.</li>
  <li>Get closer to becoming Staff Engineer.</li>
  <li>Much more…</li>
</ul>

      
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-11-03T21:31:47-08:00"><a href="http://localhost:4000/using-sensu-for-dba-tasks/">November 03, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="http://localhost:4000/about/" title="About Silvia Botros">Silvia Botros</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~4 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://localhost:4000/using-sensu-for-dba-tasks/" rel="bookmark" title="Using Sensu for DBA tasks" itemprop="url">Using Sensu for DBA tasks</a></h1>
    
  </header>
  <div class="entry-content">
      <h3 id="sensu-for-monitoring">Sensu for monitoring</h3>
<p>Here at Sendgrid we spent the last couple of years porting a lot of our service and host monitoring to <a href="https://sensuapp.org/">Sensu</a>. Its solid API support meant we could write all sorts of tooling around it. We also liked the idea of standalone, client side checks that push their status to the Sensu alerting queue asynchronously. If you are new to Sensu or haven’t ever read on it, <a href="https://sensuapp.org/docs/latest/overview">this is a good place to start</a>.</p>

<h3 id="typical-usage-example">Typical usage example</h3>

<p>The typical use I have for such standalone checks is health checks, a simple example looks like this in Sensu’s client config</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "checks": {
    "mysql_alive": {
      "command": "mysql-alive.rb -h &lt;IP&gt; -d mysql -u :::mysql.user|sensu::: -p :::mysql.password:::",
      "handlers": [
        "default"
      ],
      "standalone": true,
      "interval": 10,
      "notification": "OMG MySQL is dead!"
    }
  }
}
</code></pre></div></div>

<p>But if you look closer, all you really do is tell Sensu to run a command. So this can be…any command. This will be useful in a just a moment.</p>

<h3 id="what-i-am-solving">What I am solving</h3>

<p>I have been traditionally using the crond service for running local management tasks on databases like rotating partitions and triggering backups. Along with that, we have a report that would check the logs of these jobs, on each backup replica, and make sure they ended in success messages. This is fragile due to a number of reasons:</p>

<ul>
  <li>CronD doesn’t have any built in monitoring. It does not have a concept of ‘stale’</li>
  <li>Those reports - I will call them ‘watchers’ - are one more moving part adding complexity to the question ‘when was the last successful backup of my DB?’</li>
  <li>This setup is prone to race conditions. You must time the task and its watcher in cron exactly or else the watcher can preemptively trigger an alert or signal failure when the backup is not done yet. Any drift in duration of the task will eventually make this happen (like a backup taking longer as a database grows).</li>
  <li>What if the watcher script didn’t run? It is also in CronD - either on the same host or on another host, right? Either you find yourself in a rabbit hole of who watches the watchers, or a human has to notice that a report didn’t come out…humans aren’t good at remembering things.</li>
  <li>Changing the designation of a server means you must change it in a number of places or the watcher will watch the wrong host.</li>
  <li>We are striving to <a href="http://mcfunley.com/choose-boring-technology">keep our stack boring</a>. While newer technologies like chronos and rundeck provide more enhanced scheduling, they also need a service discovery layer to do this right. That was a bigger undertaking and too much scope creep for what I was solving.</li>
</ul>

<p>So I decided to make Sensu work to my advantage, with the help of chef roles.</p>

<h3 id="partition-rotation-in-sensu">Partition rotation in Sensu</h3>

<p>I started off by moving any credentials I need for my partition rotation script into Sensu’s redacted configuration. This is good practice for <em>anything</em> you put into sensu that uses secrets. The credentials are added in <code class="highlighter-rouge">/etc/sensu/client.json</code> then are just referenced in check configurations using <code class="highlighter-rouge">:::secret_thingie:::</code> notation.</p>

<p><em>_Protip_</em>: Sensu doesn’t know what to redact in client.json. You must also define the name of the keys you want redacted. like this..</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"redact": [
  "other_password",
  "password"
]
</code></pre></div></div>
<p>This is also not a deep merged list. As you can see I had to explicitly include ‘password’ once I needed to add another key in that list.</p>

<p>Then I needed to define the new Sensu check that rotates the partitions. I am using a chef resource as the code example.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sensu_check 'add_table_partitions' do
  command "/usr/local/pdb/bin/pdb-parted --add --interval d +7d.startof h=localhost,u=specialdbuser,p=:::redacted_partition_password:::,D=mydb,t=special_table &gt;&gt; /var/log/partition_rotation.log 2&gt;&amp;1"
  handlers %w(default_handler special_dba_handler)
  interval 86400
  standalone true
  additional(:occurrences =&gt; 3, :notification =&gt; "#{node['hostname']} failed adding partitions to important table. See log file in /var/log/mail_send_cancel_pause.log")
end
</code></pre></div></div>

<p>Let’s inspect what just happened here…</p>

<p><code class="highlighter-rouge">command</code>:  <a href="https://github.com/palominodb/PalominoDB-Public-Code-Repository/blob/master/tools/data_mgmt/t/pdb-parted/pdb-parted.t">pdb-parted</a> is a very useful perl script by the folks from Palominodb (now at <a href="http://www.pythian.com/">Pythian</a>) for rotating partitions in a MySQL DB. This is the same line I used to maintain in a crontab file configuration.</p>

<p><code class="highlighter-rouge">interval</code>: how often this Sensu check runs. In this example these are daily partitions so running the script daily was sufficient. <em>The important part here is that your script is idempotent</em>. pdb-parted is. If it finds that the needed partitions already exists, it just outputs a message to that effect and exits nicely.</p>

<p><code class="highlighter-rouge">occurrences</code>: This is the number of allowed failures before alerting. It is nice to have a buffer especially when I already configure the command to make partitions days/weeks in advance.</p>

<p>For those who use tools other than chef and want to see what the final check configuration looks like, here it is, important bits redacted:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "checks": {
    "add_table_partitions": {
      "command": "/usr/local/pdb/bin/pdb-parted --add --interval m +7m.startof h=localhost,u=specialdbuser,p=:::redacted_partition_password:::,D=mydb,t=special_table &gt;&gt; /var/log/partition_rotation.log 2&gt;&amp;1",
      "handlers": [
        "default_handler",
        "special_dba_handler"
      ],
      "standalone": true,
      "interval": 86400,
      "occurrences": 3,
      "notification": "hostname failed adding partitions to special table. See log file in /var/log/partition_rotation.log"
    }
  }
}
</code></pre></div></div>

<p>Partition rotation now has built in monitoring. If this script exits with a non zero code, the Sensu handlers take care of getting this knowledge to the predefined group of people using the method we want. We already have multiple on-call team rotations set up and escalation paths and all the other stuff that comes along with monitoring at scale. So we got to just leverage all of that rather than reinventing the wheel.</p>

<h3 id="planned-future-improvements">Planned future improvements</h3>

<p>No solution is perfect. Neither is this one.</p>

<ul>
  <li>We still run the risk of more than one machine in a cluster holding the primary role. Until service discovery is in place, this is something we can build a check for leveraging chef search.</li>
  <li>Now that tasks like backups are running in a first class citizen tool in our stack, I can more easily add stats and get graphs for how long backups take, how big backups are to make capacity planning and MTTR tracking easier.</li>
</ul>

      
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-29T20:23:02-07:00"><a href="http://localhost:4000/on-burnout/">July 29, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="http://localhost:4000/about/" title="About Silvia Botros">Silvia Botros</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~6 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://localhost:4000/on-burnout/" rel="bookmark" title="On Burnout" itemprop="url">On Burnout</a></h1>
    
  </header>
  <div class="entry-content">
      <h3 id="the-not-so-merry-go-round">The not-so-merry go round</h3>

<p>There is a lot of talk these days about burnout in our field. A lot of <a href="http://burnout.io">great</a> <a href="http://mhprompt.org">initiatives</a> to get us tech people to not hide it, not sweep it under the rug.</p>

<p>This is a great start for a more honest conversation about the stresses we all deal with in this industry and yet, a lot of the examples I see of people trying to deal with it is through quitting their current gig, taking a long vacation, then working on finding the next gig.</p>

<p>In the long run, this is not great for companies’ overall health and more importantly for a team’s health and morale. There are already statistics about how <a href="http://www.techrepublic.com/blog/career-management/tech-companies-have-highest-turnover-rate/">churn in IT is the highest compared to other fields</a> and if you are at all familiar with all the effort that goes into recruiting, hiring and on boarding in our field, you probably already know that it is an expensive process with a lead time in the months. A lot of what i ruminated over the last few weeks wasn’t just my words but also the words of a <a href="http://logikal.is/blog/2013/04/30/a-month-to-myself/">dear colleague</a> who had to do this exact thing a few years back.</p>

<h3 id="seeing-it">Seeing it</h3>

<p>It may be irrelevant whether our industry makes us wanna appear invincible or if this industry just attracts those of us who want to always appear strong and have it all figured out. But I know <em>I</em> always try to do that. Family, kid, plus managing a database layer that has expanded twenty-fold in my three and a half years with my current job.</p>

<p>Let me start with saying that I do not do it alone. Early on we hired consultants to help off load a lot of the DBA tasks. But in the end of the day, I’ve always felt that I am the in house DBA, I own the performance, management, and health of these systems.</p>

<p>This sense of ownership, while lauded, led me to unrealistic expectations of myself. I was checking work chat all the time, checking email all the time. I had slipped into a pattern of coupling being online/available all the time with doing a good job.</p>

<p>As the months and quarters rolled by, cracks started to appear.</p>

<p>I was having less fun with spending time with developers, talking distributed system architecture. Suddenly, I was having the ‘Sunday evening dread’…something I didn’t really think would happen working on so many exciting things and interesting problems for so long.  I could see the snark levels increase in my conversations..</p>

<p>“yeah I will test this new shiny thing in maybe a few years”</p>

<p>“Sure…we will someday deprecate this old thing!”</p>

<h3 id="corroborating-evidence">Corroborating evidence</h3>

<p>Sometimes even though we know something, we need an external source with more experience to confirm to us that it is true, that we aren’t just ‘not good enough’. For me, a lot of that was talks by <a href="https://twitter.com/lxt">Laura Thompson</a> of Mozilla. The <a href="http://original.livestream.com/etsycodeascraft/video?clipId=pla_b7da40fe-ac51-4a87-ac0b-6002899457eb&amp;utm_source=lslibrary&amp;utm_medium=ui-thumb">first</a> is more directed at managers but it absolutely helped me. The <a href="https://vimeo.com/131484322">second</a> was at this year’s Monitorama. All the signs were there. The decrease in my github activity, the constant feeling that I was fighting emergencies all the time, physical and emotional exhaustion, sense of ineffectiveness and lack of accomplishment (Yes, I am now directly quoting the slides)</p>

<h3 id="what-to-do">What to do</h3>

<h4 id="own-your-boundaries">Own your boundaries</h4>

<p>Being able to separate the time you are working from the time you are not is paramount. In the end, no one owns my well being more than me. I work remote in a different timezone than my team so boundaries were extra important to establish.</p>

<p>I started off by disallowing any push notifications for work hipchat on my phone. Not accepting meetings past 5 PM. Removing work email from the phone and most importantly, the laptop doesn’t leave the office room during the week.</p>

<p>What helped me the most was turning off work email on my phone. I needed to accept that email is an asynchronous method of communication and that I shouldn’t feel guilty about not checking it every hour including right before going to sleep. I know this may sound incredibly obvious to some but for me the checking work email and work chat from the phone constantly was like an itch and it took me a while to accept that it was an expectation I was setting for myself and that in the long run it was not making me a more productive employee or a better engineer in any way.</p>

<h4 id="talk-to-your-team">Talk to your team</h4>

<p>The roles here differ depending on whether you are a manager, or individual contributor. None of this could work without support from my team, including management.</p>

<p><em>Managers, this is how you avoid churn</em>.  You need to make sure your team feels safe saying they need a break and to feel safe taking it. None of this ‘unlimited vacation time’ nonsense if no one is actually going on vacation. 1:1s are supremely important here. I am not ignoring that a busy team also means an overwhelmed manager sometimes but this is the time where you as a leader must prioritize keeping in touch with the team than anything else.</p>

<p>/soapbox</p>

<p>I am an Individual contributor but I am also one of the more senior team members (in tenure) so accepting that I carry some of the responsibility of setting the tone was necessary. Besides being honest with myself, I needed to be honest with my team. I started letting my project manager and my lead know that I would be staying off chat in the evening. Making sure they have a way to get a hold of me and trusting <em>them</em> that they will truly only use it sparingly and in emergencies. Without that framework and their support, I may know what I need but I would not feel empowered to act on it and I am very grateful that they let me do that and do the same for themselves so we can all continue working together.</p>

<h4 id="talk-to-someone">Talk to someone</h4>

<p>This doesn’t have to be a mental health professional although that is also a good thing to do. But in the simpler sense it helps a lot to talk to people who have been or are still going through the same thing, even with a few minor details altered. There is a lot of us in <a href="http://signup.hangops.com">hangops.slack.com</a> who have stories and scars from this. So much so that we have a dedicated mental health channel.</p>

<h4 id="work-in-progress">Work in progress</h4>

<p>I mentioned in the beginning how I see most people deal with this situation. And there many of us. Does this mean I am looking for a new gig? No. This is not a quitting post :) I like my team. A lot. And I don’t just want to continue working with them but to continue to enjoy it and I want to see them also have a good time working with me. This work in progress has to always start with me recognising what I need and communicating it but I also have a team that has supported the steps I took to ease the stress.</p>

<p>I can’t stress this enough. I am still learning how to deal with this. I know now I always will be. It is a fine line between being someone who is honest about their work, always caring to go the extra mile and do right by their employer without sacrificing their sanity and inner peace.</p>

<p>I don’t want to eventually feel contempt and resentment towards that work. I am also not arguing for slacking off in the name of life work balance. Too many companies don’t put a lot of value in keeping their employees healthy in mind as well as body and that is a very good reason to look for another gig, and there are companies that are aware of these pressures and challenges but are only beginning to truly acknowledge them and begin a conversation about them.</p>

<p>It is on all of us to not try to be individual heroes/ninjas/rockstars and instead promote teams of healthy, rested, smart engineers with well balanced lives.</p>

<p><em>Many thanks to Sean Kilgore, Jennifer Davis and Charity Majors for helping put these thoughts to words</em></p>


      
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-03-06T14:47:41-08:00"><a href="http://localhost:4000/alfred-csshx-and-terminalception/">March 06, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="http://localhost:4000/about/" title="About Silvia Botros">Silvia Botros</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://localhost:4000/alfred-csshx-and-terminalception/" rel="bookmark" title="Alfred, csshx and terminalception" itemprop="url">Alfred, csshx and terminalception</a></h1>
    
  </header>
  <div class="entry-content">
      <h3 id="alfred-csshx-and-terminalception">Alfred, csshx and terminalception</h3>

<p>I use Tmux usually but Tmux on the mac has not been playing nice with csshx for me. Something in the dark magic of perl broke with an error that looks like this</p>

<blockquote>
  <p>Mar  5 08:58:42 silvias-MacBookPro.local perl[10828] <Error>: ImageIO: CGImageDestinationFinalize image destination must have at least one image
2015-03-05 08:58:42.473 perl5.18[10828:2436454] CGImageDestinationFinalize failed for output type 'public.tiff'
**** ERROR **** PerlObjCBridge:: convertPerlToObjC(): Referenced thingy not blessed
**** ERROR **** PerlObjCBridge:: convertArg() for index 2: convertPerlToObjC() failed
**** ERROR **** PerlObjCBridge:: sendObjcMessage: Error converting argument 1 for message "setObject:forKey:"
**** ERROR **** PerlObjCBridge: error [1] sending message [__NSDictionaryM setObject:forKey:] at /System/Library/Perl/Extras/5.18/darwin-thread-multi-2level/PerlObjCBridge.pm line 248.</Error></p>
</blockquote>

<p>But I wasn’t about to let that take away my terminalception magic :)</p>

<p>Note: This is for a mac environment but you may emulate it in your favourite distro by replacing Alfred with whatever launcher you may use.</p>

<h4 id="what-you-need">What you need</h4>
<p>Alfred app is my favorite launcher in mac but I suspect Quicksilver (if you are the quaint type) can also run commands directly to the terminal.</p>

<p>Next install Homebrew. You need this to install csshx easily. Also because GNU tools :)
<code class="highlighter-rouge">ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"</code></p>

<p>Install csshx</p>

<p><code class="highlighter-rouge">brew install csshx</code></p>

<p>If you are chef shop like mine, a lot of times what you are looking for is to ssh to all the machines of a certain type. In chef, we call those roles. This step will change depending on the configuration management/service discovery framework of choice in your infrastructure.</p>

<p>First, set the terminal app your alfred will use. I set it to Terminal because I wanted this to be separate from my usual workspace in iTerm 2</p>

<p><img src="https://farm1.staticflickr.com/735/22396914786_e46c0ed4cd_b.jpg" alt="Alfred settings" /></p>

<p>Then, when I want to fire up csshX to a bunch of our our servers all at once, it usually looks like this.</p>

<p><em>Protip</em>: knife ssh can take cssh as an argument, so no awk and bash pipes required.</p>

<p><img src="https://farm6.staticflickr.com/5793/22433815321_7b1f1fced2_b.jpg" alt="alfred term" /></p>

<p>This fires up Terminal, which runs the chef search, and opens separate windows.</p>

<p><img src="https://farm6.staticflickr.com/5805/22422959375_891c2f313a_k.jpg" alt="csshx cap" /></p>

<p>Your cursor will be in the bottom red window by default and input will appear in all the windows at the same time. When done, CMD+Q will bring this window</p>

<p><img src="https://farm1.staticflickr.com/744/22422971645_735d9473b9_b.jpg" alt="quit window" /></p>

<p>And done :)</p>

      
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-02-13T01:49:42-08:00"><a href="http://localhost:4000/learning-configuration-management-as-a-dba/">February 13, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="http://localhost:4000/about/" title="About Silvia Botros">Silvia Botros</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~4 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="http://localhost:4000/learning-configuration-management-as-a-dba/" rel="bookmark" title="Learning configuration management as a DBA" itemprop="url">Learning configuration management as a DBA</a></h1>
    
  </header>
  <div class="entry-content">
      <h3 id="how-its-been">How it’s been</h3>
<p>Before SendGrid, I used to deploy all my databases by hand. I’d have a documentation page (a google doc, internal wiki page…whatever). And it would be a long bulleted list of “Install this, then install this”. If you have ever maintained ‘How to’ documents like that, This picture will eventually ring true.</p>

<p><img src="http://s4.postimg.org/44kc215hp/code_comment.png" alt="code comments" /></p>

<p>This was not a good approach, obviously. Especially when small details start changing but the ‘documentation’ lags behind. Now you have a situation that enables tribal knowledge which means 3 am ops person who is not the DBA has even less of an ability to know what should be running on a database and how it should look like under normal operations.</p>

<h3 id="multiply-bya-lot">Multiply by…a lot</h3>
<p>Then came my largest deployment to date at Sendgrid. We needed a data store for storing the click and open tracking for our short URLs and we decided to use MySQL as the place for this. This was going to be a ton of rows with a high demand on fast writes and supporting a <em>lot</em> of reads. So a single instance was not going to cut it.</p>

<p>Because MySQL 5.5 was the standard GA version at the time, we were still limited to a MySQL that didn’t very efficiently use all the cores newer server configuraitons could offer. So to squeeze out the most performance out of our not so cheap hardware, we also decided to house 5 MySQL instances per box. The way to do that was add a Virtual IP per instance on the box, use distinct data directories and config files per instance while still making sure that all 5 instances are ‘equal’ so as not to let one starve the others of system resources.</p>

<h3 id="enter-chef">Enter chef</h3>
<p>As you can see where I am going with this, it became very clear to me that I could not successfully deploy this new cluster (the biggest I had done yet) using the same old method. I needed a way to automate the building of these clusters and I needed that to also be an easy method of maintaining the state of these clusters (configuration or MySQL and teh system underneath) in code.</p>

<p>So why chef? Simply put, it was what Sendgrid had already been using for configuration management and what is now often called ‘Infrastructure as code’. I wanted this datastore to begin the effort of not making what I do seem like black magic…because it really isn’t. I work with a team of great operations engineers and when trying to scale traffic to double or more annually with a not very big team, consistency of tools is of extreme importance.</p>

<h3 id="what-i-learned">What I learned</h3>
<p>Learning chef as a DBA was an interesting experience. I will preface this section by saying that 2 years later, I am rewriting not just the cookbook for this data cluster but all of my chef code at Sendgrid. There are many things I learned the hard way in that first major iteration and I can imagine the same pitfalls happening to others in a DBA or similar roles in other companies.</p>

<p><em>Write your own cookbook</em></p>

<p>I am not going to go into code samples. There are a few community cookbooks for installing MySQL/Percone Server and I consider them all a great place to find examples. Yes, you can absolutely grab them and deploy MySQL with them and I imagine for many budding teams this may be a very fine path to take. But know the debt you take on when grabbing someone else’s code to deploy your infrastructure. I chose from the very beginning to write my own cookbook because by the time I started, Sendgrid was already doing a huge throughput and that comes with a number of tweaks.</p>

<p><em>When things are similar but not the same</em></p>

<p>When I started on this cookbook writing adventure, I thought my different database clusters were similar enough to use one cookbook with just some attribute differences. And maybe when I strated 2+ years ago that was true. Very quickly though, as we sharded more tables into their own clusters, plus added a few more brand new projects using MySQL, that stopped being true. I found myself maintaining the monorail of database cookbooks. Making its testing strategy truly comprehensive meant 3 test kitchen suites <em>per database kind</em>. Build times grew exponentially.</p>

<p>This is why in this rewrite I am heavily using what is basically a wrapper style. Yes, most of my MySQL deployments use what is more or less the same pattern, but usually in the post server install time, things diverge. And there are few things as frustrating as watching a multi hour jenkins build because I changed a config file for a specific database type.</p>

<p><em>Embrace your organisation’s cookbook hierarchy</em></p>

<p>Besides automation, making my life easier…etc. First and foremost, I decided to learn chef and write cookbooks for our databases because <em>database land should not be an island</em>. This is why in my rewrites I made sure the operations engineering team reviewed my code. Not only is peer review from them, being immersed in chef the most, so useful. They also know what parts of system management we decided to turn into internal lightweight resources, making my code even simpler and no reinventing my mostly the same but not quite wheel. This has made the rewritten cookbooks much easier to follow and maintain.</p>

<p>This rewrite is not done. I only have a few clusters left with cookbooks in progress for them already. I have learned quite a lot about being a operations engineer working on this project.</p>

      
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<div class="pagination">
  <ul class="inline-list">
    
    
      
        <li><a href="http://localhost:4000/" class="btn">Previous</a></li>
      
    

    
    
      <li><a href="http://localhost:4000/">1</a></li>
    

    
    

    
    
    

    
      
        <li><strong class="current-page">2</strong></li>
      
    

    
    

    
      <li><a href="http://localhost:4000/page3/">3</a></li>
    

    
    
      <li><a href="http://localhost:4000/page3/" class="btn">Next</a></li>
    
  </ul>
</div>


</div><!-- /#main -->

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript">window.jQuery || document.write('<script type="text/javascript" src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script type="text/javascript" src="http://localhost:4000/assets/js/scripts.min.js"></script>
<script type="text/javascript" async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
<script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>







<script type="text/javascript">
    sharing();
</script>



<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2017 Silvia Botros. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://github.com/aron-bordin/neo-hpstr-jekyll-theme" rel="nofollow">Neo-HPSTR Theme</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->

</body>
</html>
